# Completion

This page explains completion for gobgp client.

## Bash completion

The described how to use and how to customize of bash completion.

### How to use

1. install bash-completion as follows:

 ```
 % sudo apt-get install bash-completion
 ```

1. add gobgp's path to PATH environment variable

 If you run 'go get github.com/osrg/gobgp/gobgp', gobgp command is installed in $GOPATH/bin.
 ```
 % export PATH=$PATH:$GOPATH/bin
 ```

1. load completion file

 ```
 % source $GOPATH/src/github.com/osrg/gobgp/tools/completion/gobgp-completion.bash
 ```

You can use tab completion for gobgp after loading gobgp-completion.bash.

### How to customize
 Customize the bash completion, first generate the based bash completion file using command of gobgp client, second copy the new functions （it was generated by adding the command） to **gobgp_static_completion.bash** , third implement to **gobgp_dynamic_completion.sh** if you wish to use dynamic completion, finally delete the bash completion file that was generated.

1. generate based bash completion file

 generate the based bash completion file use binary of gobgp client.
 ```
 % gobgp --gen-cmpl --bash-cmpl-file=<specifying a file name>
  ```

1. copy the new functions

 Copy the new functions to **gogbp-static-completion.bash**, that generated by command of gobgp client.
 For example, if the following function is newly generated by the addition of command(such as **gobgp neighbor** command), it will copy it.

 ```
 _gobgp_monitor_neighbor()
 {
     last_command="gobgp_neighbor"
     commands=()

     flags=()
     two_word_flags=()
     flags_with_completion=()
     flags_completion=()

     flags+=("--bash-cmpl-file=")
     flags+=("--debug")
     flags+=("-d")
     flags+=("--gen-cmpl")
     flags+=("-c")
     flags+=("--host=")
     two_word_flags+=("-u")
     flags+=("--json")
     flags+=("-j")
     flags+=("--port=")
     two_word_flags+=("-p")
     flags+=("--quiet")
     flags+=("-q")

     must_have_one_flag=()
     must_have_one_noun=()

     # Defined in the case of a dynamic completion
     __gobgp_q_neighbor
 }
  ```

1. implement a dynamic completion

 If you want to a dynamic completion, you need to implement that part yourself.
 For example, if you want to completion the address of the neighbor following after the **gobgp neighbor** command, you implement a command to request a list of the neighbor to gobgpd and implement process of subsequent.

 ##### implement command to request a list of the neighbor.

 ```
 # Get bgp neighbors use gobgp command.
 __gobgp_q_neighbor()
 {
     local neighbors=( $(__gobgp_q $url $port --quiet neighbor) )
     case "${neighbors[*]}" in
         "grpc: timed out"* | "rpc error:"* )
             req_faild="True"
             return
         ;;
     esac
     for n in ${neighbors[*]}; do
         commands+=($n)
     done
 }
 ```

 ##### implement a process of subsequent to __handle_gobgp_command () function.

  **next_command** variable indicates a function to be called to the next.
  Therefore, to implement the reference destination of the function  a **bash-static-completion.bash** reference.

 ```
 case "${last_command}" in
     # Control after dynamic completion of bgp neighbor command
     gobgp_neighbor )
         next_command="_${last_command}_addr"
     ;;
 esac
 ```

1. delete the generate bash completion file.

## Zsh completion

The described how to use of bash completion.

### How to use

zsh completion for gobgp works by adding the path of gobgp zsh completion directory to $fpath and enabling zsh completion like below:

 ```
 % vi ~/.zshrc

 GOBGP_COMP=$GOPATH/src/github.com/osrg/gobgp/tools/completion/zsh
 fpath=($GOBGP_COMP $fpath)

 autoload -Uz compinit
 compinit

 ```